var E=(v,h,i)=>new Promise((b,c)=>{var u=r=>{try{d(i.next(r))}catch(p){c(p)}},s=r=>{try{d(i.throw(r))}catch(p){c(p)}},d=r=>r.done?b(r.value):Promise.resolve(r.value).then(u,s);d((i=i.apply(v,h)).next())});import{d as j,z as J,R as S,A as O,B as X,D as Z}from"./index.90881ba4.js";import{f as G}from"./dateUtil.e0ac7f3e.js";import{T as H}from"./TableAction.f4a71aa5.js";import{d as K,a3 as Q,a4 as W,f as Y,k as w,h as x,aJ as ee,o as m,c as A,V as a,X as o,u as t,_ as g,N as ue,bN as te,ah as C,Z as D,F as ne,r as ae,bh as y,t as le,a as oe,aR as se,az as re,aN as ie,aM as pe,a2 as me,aj as ce,ci as de,aV as _e,av as fe,ai as Fe,aD as ge,aC as ye}from"./vendor.b23ac7e6.js";import"./useDesignSetting.37c45417.js";import"./index.esm.f571281f.js";const he=y(" \u6DFB\u52A0\u83DC\u5355 "),be={style:{"margin-left":"80px"}},Ce=y("\u4FDD\u5B58"),De=y("\u53D6\u6D88"),Ae=K({setup(v){const{hasPermission:h}=j(),i=Q(),b=W();let c=Y();const u=w({name:"",parentId:0,path:"",permission:"",type:1,component:""}),s=w({drawersShow:!1,title:"\u7F16\u8F91\u6743\u9650",authType:[{value:0,label:"\u76EE\u5F55"},{value:1,label:"\u83DC\u5355"},{value:2,label:"\u6309\u94AE"}],columns:[{title:"\u83DC\u5355\u540D\u79F0",key:"name"},{title:"\u7C7B\u578B",key:"type",render(e){return[x(ee,{size:"small",type:e.type===0?"primary":e.type===1?"warning":"success"},e.type===0?"\u76EE\u5F55":e.type===1?"\u83DC\u5355":"\u6309\u94AE")]}},{title:"\u6743\u9650\u6807\u8BC6",key:"permission"},{title:"\u8DEF\u7531\u540D\u79F0",key:"component"},{title:"\u8BF7\u6C42\u5730\u5740",key:"path"},{title:"\u66F4\u65B0\u65F6\u95F4",key:"updateTime",render(e){return G(e.updateTime)}},{title:"\u64CD\u4F5C",key:"actions",render(e){return x(H,{style:"button",actions:[{size:"small",type:"primary",label:"\u6DFB\u52A0",style:{marginRight:"10px"},ifShow:()=>e.type!==2,auth:["add"],onClick:()=>k(e.id,e.lavel)},{size:"small",type:"primary",label:"\u7F16\u8F91",style:{marginRight:"10px"},ifShow:()=>!0,auth:["edit"],onClick:()=>T(e)},{size:"small",type:"error",label:"\u5220\u9664",style:{marginRight:"10px"},ifShow:()=>!0,auth:["delete"],onClick:()=>z(e)}]})}}],tableData:[]}),d={name:{required:!0,message:"\u8BF7\u8F93\u5165\u6743\u9650\u540D\u79F0",trigger:"blur"},type:{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6743\u9650\u7C7B\u578B",trigger:"change"},component:{required:!0,message:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u5730\u5740",trigger:"blur"},permission:{required:!0,message:"\u8BF7\u8F93\u5165\u6743\u9650\u6807\u8BC6",trigger:"blur"},path:{required:!0,message:"\u8F93\u5165\u8BF7\u6C42\u5730\u5740",trigger:"blur"}},r=()=>E(this,null,function*(){let e=yield O({menuType:"nav"});s.tableData=e.data.menus,p=1,B(s.tableData),console.log("%c \u{1F958} res: ","font-size:20px;background-color: #FFDD4D;color:#fff;",e)});let p=1;function B(e){e.map(n=>{n.lavel=p,n.children.length>0&&(p++,B(n.children))})}r();function z(e){console.log(e),b.warning({title:"\u8B66\u544A",content:"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u786E\u5B9A\u5220\u9664\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u4E0D\u786E\u5B9A",onPositiveClick:()=>{J(e.id).then(n=>{n.code===S.SUCCESS?(i.success("\u5220\u9664\u6210\u529F"),r()):i.error("\u5220\u9664\u5931\u8D25")})}})}function T(e){console.log("%c \u{1F955} row: ","font-size:20px;background-color: #4b4b4b;color:#fff;",e),s.drawersShow=!0,s.title="\u7F16\u8F91\u83DC\u5355",u.name=e.name,u.parentId=e.parentId,u.id=e.id,u.type=e.type,u.path=e.path,u.permission=e.permission,u.component=e.component,console.log(e)}function k(e,n){s.drawersShow=!0,s.title="\u6DFB\u52A0\u6743\u9650",u.name="",u.parentId=e,u.type=n,u.path="",u.permission="",u.component="",console.log("%c \u{1F36F} id: ","font-size:20px;background-color: #42b983;color:#fff;",e)}function M(){c.value.validate(e=>{e?i.error("\u9A8C\u8BC1\u5931\u8D25\uFF0C\u8BF7\u586B\u5199\u5B8C\u6574\u4FE1\u606F"):(s.title==="\u6DFB\u52A0\u6743\u9650"?X:Z)(u).then(_=>{console.log("%c \u{1F956} res: ","font-size:20px;background-color: #6EC1C2;color:#fff;",_),_.code===S.SUCCESS?(i.success("\u64CD\u4F5C\u6210\u529F"),r(),s.drawersShow=!1):i.error(_.message)})})}return(e,n)=>{const _=se,R=re,N=ie,U=pe,F=me,f=ce,q=de,V=_e,$=fe,I=Fe,P=ge,L=ye;return m(),A("div",null,[a(U,{class:"mt-4",cols:"24",responsive:"screen","x-gap":24},{default:o(()=>[a(N,{span:"24"},{default:o(()=>[a(R,{segmented:{content:"hard"},bordered:!1,size:"small"},{default:o(()=>[t(h)(["add"])?(m(),g(t(C),{key:0,type:"primary",class:"mb-5",onClick:n[0]||(n[0]=l=>k(-1,0))},{icon:o(()=>[a(t(ue),null,{default:o(()=>[a(t(te))]),_:1})]),default:o(()=>[he]),_:1})):D("",!0),a(_,{columns:t(s).columns,data:t(s).tableData,"row-key":l=>l.id},null,8,["columns","data","row-key"])]),_:1})]),_:1})]),_:1}),a(L,{show:t(s).drawersShow,"onUpdate:show":n[7]||(n[7]=l=>t(s).drawersShow=l),width:502,placement:"left"},{default:o(()=>[a(P,{title:t(s).title,closable:""},{default:o(()=>[a(I,{"label-width":80,model:t(u),rules:d,"label-placement":"left",ref_key:"formRef",ref:c,class:"py-8"},{default:o(()=>[a(f,{label:"\u6743\u9650\u540D\u79F0",path:"name"},{default:o(()=>[a(F,{value:t(u).name,"onUpdate:value":n[1]||(n[1]=l=>t(u).name=l),placeholder:"\u8F93\u5165\u6743\u9650\u540D\u79F0"},null,8,["value"])]),_:1}),a(f,{label:"\u6743\u9650\u7C7B\u578B",path:"type"},{default:o(()=>[a(V,{value:t(u).type,"onUpdate:value":n[2]||(n[2]=l=>t(u).type=l),size:"medium"},{default:o(()=>[(m(!0),A(ne,null,ae(t(s).authType,l=>(m(),g(q,{key:l.value,value:l.value},{default:o(()=>[y(le(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(u).type<2?(m(),g(f,{key:0,label:"\u8DEF\u7531\u540D\u79F0",path:"component"},{default:o(()=>[a(F,{value:t(u).component,"onUpdate:value":n[3]||(n[3]=l=>t(u).component=l),placeholder:"\u8F93\u5165\u8DEF\u7531\u540D\u79F0"},null,8,["value"])]),_:1})):D("",!0),t(u).type>1?(m(),g(f,{key:1,label:"\u6743\u9650\u6807\u8BC6",path:"permission"},{default:o(()=>[a(F,{value:t(u).permission,"onUpdate:value":n[4]||(n[4]=l=>t(u).permission=l),placeholder:"\u8F93\u5165\u6743\u9650\u6807\u8BC6"},null,8,["value"])]),_:1})):D("",!0),a(f,{label:"\u8BF7\u6C42\u5730\u5740",path:"path"},{default:o(()=>[a(F,{value:t(u).path,"onUpdate:value":n[5]||(n[5]=l=>t(u).path=l),placeholder:"\u8F93\u5165\u8BF7\u6C42\u5730\u5740"},null,8,["value"])]),_:1}),oe("div",be,[a($,null,{default:o(()=>[a(t(C),{type:"primary",class:"min-btn",onClick:M},{default:o(()=>[Ce]),_:1}),a(t(C),{type:"default",class:"min-btn",onClick:n[6]||(n[6]=l=>t(s).drawersShow=!1)},{default:o(()=>[De]),_:1})]),_:1})])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])])}}});export{Ae as default};
