var re=Object.defineProperty,ie=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var J=(e,l,o)=>l in e?re(e,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[l]=o,B=(e,l)=>{for(var o in l||(l={}))fe.call(l,o)&&J(e,o,l[o]);if(H)for(var o of H(l))ce.call(l,o)&&J(e,o,l[o]);return e},K=(e,l)=>ie(e,de(l));var _=(e,l,o)=>new Promise((m,c)=>{var g=s=>{try{r(o.next(s))}catch(b){c(b)}},n=s=>{try{r(o.throw(s))}catch(b){c(b)}},r=s=>s.done?m(s.value):Promise.resolve(s.value).then(g,n);r((o=o.apply(e,l)).next())});import{n as q,p as pe,m as ee,q as X,l as me,_ as _e,r as ge,t as be,v as ye}from"./index.f8f7641c.js";import{u,B as Z,by as ve,d as Fe,bL as Be,bS as Pe,bG as ke,f as V,k as we,l as N,bi as te,g as Oe,T as G,o as p,_ as y,X as i,V as k,c as Q,r as W,bA as h,bI as Ve,bh as M,t as j,bT as Y,a9 as x,F as L,bH as Se,Z as R,bJ as Ce,bK as Ne,N as he,aw as Me,al as je,av as Te,ak as Ue,a2 as De,aW as Ee,aV as Re,aj as $e,aN as Ie,ah as ze,aM as Ae,ai as Ge,i as Qe,bo as We}from"./vendor.ad09d2ba.js";import{p as z}from"./TableAction.8d09685d.js";function Le(e){return e==="NInput"?"\u8BF7\u8F93\u5165":["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"\u8BF7\u9009\u62E9":""}function qe({emit:e,getProps:l,formModel:o,getSchema:m,formElRef:c,defaultFormModel:g,loadingSub:n,handleFormValues:r}){function s(){return _(this,null,function*(){var a;return(a=u(c))==null?void 0:a.validate()})}function b(a){return _(this,null,function*(){a&&a.preventDefault(),n.value=!0;const{submitFunc:v}=u(l);if(v&&q(v)){yield v();return}if(!!u(c))try{return yield s(),n.value=!1,e("submit",o),!0}catch(P){return n.value=!1,!1}})}function w(){return _(this,null,function*(){var a;yield(a=u(c))==null?void 0:a.restoreValidation()})}function T(){return _(this,null,function*(){const{resetFunc:a,submitOnReset:v}=u(l);if(a&&q(a)&&(yield a()),!u(c))return;Object.keys(o).forEach(O=>{o[O]=u(g)[O]||null}),yield w();const P=r(Z(u(o)));e("reset",P),v&&(yield b())})}function U(){return u(c)?r(Z(u(o))):{}}function D(a){return _(this,null,function*(){const v=u(m).map(F=>F.field).filter(Boolean);Object.keys(a).forEach(F=>{const P=a[F];v.includes(F)&&(o[F]=P)})})}return{handleSubmit:b,validate:s,resetFields:T,getFieldsValue:U,clearValidate:w,setFieldsValue:D}}function He({defaultFormModel:e,getSchema:l,formModel:o}){function m(g){if(!pe(g))return{};const n={};for(const r of Object.entries(g)){let[,s]=r;const[b]=r;!b||ee(s)&&s.length===0||q(s)||X(s)||(me(s)&&(s=s.trim()),ve(n,b,s))}return n}function c(){const g=u(l),n={};g.forEach(r=>{const{defaultValue:s}=r;X(s)||(n[r.field]=s,o[r.field]=s)}),e.value=n}return{handleFormValues:m,initDefault:c}}const Je={labelWidth:{type:[Number,String],default:80},schemas:{type:[Array],default:()=>[]},layout:{type:String,default:"inline"},inline:{type:Boolean,default:!1},size:{type:String,default:"medium"},labelPlacement:{type:String,default:"left"},isFull:{type:Boolean,default:!0},showActionButtonGroup:z.bool.def(!0),showResetButton:z.bool.def(!0),resetButtonOptions:Object,showSubmitButton:z.bool.def(!0),submitButtonOptions:Object,showAdvancedButton:z.bool.def(!0),submitButtonText:{type:String,default:"\u67E5\u8BE2"},resetButtonText:{type:String,default:"\u91CD\u7F6E"},gridProps:Object,giProps:Object,baseGridStyle:{type:Object},collapsed:{type:Boolean,default:!1},collapsedRows:{type:Number,default:1}};const Ke=Fe({name:"BasicUpload",components:{DownOutlined:Be,UpOutlined:Pe,QuestionCircleOutlined:ke},props:B({},Je),emits:["reset","submit","register"],setup(e,{emit:l,attrs:o}){const m=V({}),c=we({}),g=V({}),n=V(null),r=V(null),s=V(!0),b=V(!1),w=V(!1),T=N(()=>Object.assign({size:e.size,type:"primary"},e.submitButtonOptions)),U=N(()=>Object.assign({size:e.size,type:"default"},e.resetButtonOptions));function D(f){var C;const S=(C=f.componentProps)!=null?C:{},E=f.component;return B({clearable:!0,placeholder:Le(u(E))},S)}const a=N(()=>{const f=B(B({},e),u(g)),S={rules:{}};return(f.schemas||[]).forEach(C=>{C.rules&&ee(C.rules)&&(S.rules[C.field]=C.rules)}),B(B({},f),u(S))}),v=N(()=>{const{layout:f}=u(a);return f==="inline"}),F=N(()=>{const{gridProps:f}=u(a);return K(B({},f),{collapsed:v.value?s.value:!1,responsive:"screen"})}),P=N(()=>B(B(B({},o),e),u(a))),O=N(()=>{const f=u(n)||u(a).schemas;for(const S of f){const{defaultValue:E}=S;E&&(S.defaultValue=E)}return f}),{handleFormValues:A,initDefault:$}=He({getProps:a,defaultFormModel:m,getSchema:O,formModel:c}),{handleSubmit:I,validate:t,resetFields:d,getFieldsValue:ne,clearValidate:oe,setFieldsValue:le}=qe({emit:l,getProps:a,formModel:c,getSchema:O,formElRef:r,defaultFormModel:m,loadingSub:b,handleFormValues:A});function se(){s.value=!s.value}function ae(f){return _(this,null,function*(){g.value=ge(u(g)||{},f)})}const ue={getFieldsValue:ne,setFieldsValue:le,resetFields:d,validate:t,clearValidate:oe,setProps:ae,submit:I};return te(()=>O.value,f=>{u(w)||(f==null?void 0:f.length)&&($(),w.value=!0)}),Oe(()=>{$(),l("register",ue)}),{formElRef:r,formModel:c,getGrid:F,getProps:a,getBindValue:P,getSchema:O,getSubmitBtnOptions:T,getResetBtnOptions:U,handleSubmit:I,resetFields:d,loadingSub:b,isInline:v,getComponentProps:D,unfoldToggle:se}}});function Xe(e,l,o,m,c,g){const n=G("QuestionCircleOutlined"),r=he,s=Me,b=je,w=Te,T=Ue,U=De,D=Ee,a=Re,v=$e,F=Ie,P=ze,O=G("DownOutlined"),A=G("UpOutlined"),$=Ae,I=Ge;return p(),y(I,h(e.getBindValue,{model:e.formModel,ref:"formElRef"}),{default:i(()=>[k($,Ce(Ne(e.getGrid)),{default:i(()=>[(p(!0),Q(L,null,W(e.getSchema,t=>(p(),y(F,h(t.giProps,{key:t.field,style:t.style||"grid-column: span 1 / span 1;"}),{default:i(()=>[k(v,{label:t.label,path:t.field},Ve({default:i(()=>[t.slot?x(e.$slots,t.slot,{key:0,model:e.formModel,field:t.field,value:e.formModel[t.field]},void 0,!0):t.component==="NCheckbox"?(p(),y(T,{key:1,value:e.formModel[t.field],"onUpdate:value":d=>e.formModel[t.field]=d},{default:i(()=>[k(w,null,{default:i(()=>[(p(!0),Q(L,null,W(t.componentProps.options,d=>(p(),y(b,{key:d.value,value:d.value,label:d.label},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):t.component==="NInputTextArea"?(p(),y(U,h({key:2},e.getComponentProps(t),{type:"textarea",is:t.component,value:e.formModel[t.field],"onUpdate:value":d=>e.formModel[t.field]=d,class:{isFull:t.isFull!=!1&&e.getProps.isFull}}),null,16,["is","value","onUpdate:value","class"])):t.component==="NRadioGroup"?(p(),y(a,{key:3,value:e.formModel[t.field],"onUpdate:value":d=>e.formModel[t.field]=d},{default:i(()=>[k(w,null,{default:i(()=>[(p(!0),Q(L,null,W(t.componentProps.options,d=>(p(),y(D,{key:d.value,value:d.value},{default:i(()=>[M(j(d.label),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):(p(),y(Se(t.component),h({key:4},e.getComponentProps(t),{value:e.formModel[t.field],"onUpdate:value":d=>e.formModel[t.field]=d,class:{isFull:t.isFull!=!1&&e.getProps.isFull}}),null,16,["value","onUpdate:value","class"])),t.suffix?x(e.$slots,t.suffix,{key:5,model:e.formModel,field:t.field,value:e.formModel[t.field]},void 0,!0):R("",!0)]),_:2},[t.labelMessage?{name:"label",fn:i(()=>[M(j(t.label)+" ",1),k(s,{trigger:"hover",style:Y(t.labelMessageStyle)},{trigger:i(()=>[k(r,{size:"18",class:"cursor-pointer text-gray-400"},{default:i(()=>[k(n)]),_:1})]),default:i(()=>[M(" "+j(t.labelMessage),1)]),_:2},1032,["style"])])}:void 0]),1032,["label","path"])]),_:2},1040,["style"]))),128)),e.getProps.showActionButtonGroup?(p(),y(F,{key:0,span:e.isInline?"":24,suffix:!!e.isInline},{default:i(({overflow:t})=>[k(w,{align:"center",justify:e.isInline?"end":"start",style:Y({"margin-left":`${e.isInline?12:e.getProps.labelWidth}px`})},{default:i(()=>[e.getProps.showSubmitButton?(p(),y(P,h({key:0},e.getSubmitBtnOptions,{onClick:e.handleSubmit,loading:e.loadingSub}),{default:i(()=>[M(j(e.getProps.submitButtonText),1)]),_:1},16,["onClick","loading"])):R("",!0),e.getProps.showResetButton?(p(),y(P,h({key:1},e.getResetBtnOptions,{onClick:e.resetFields}),{default:i(()=>[M(j(e.getProps.resetButtonText),1)]),_:1},16,["onClick"])):R("",!0),e.isInline&&e.getProps.showAdvancedButton?(p(),y(P,{key:2,type:"primary",text:"","icon-placement":"right",onClick:e.unfoldToggle},{icon:i(()=>[t?(p(),y(r,{key:0,size:"14",class:"unfold-icon"},{default:i(()=>[k(O)]),_:1})):(p(),y(r,{key:1,size:"14",class:"unfold-icon"},{default:i(()=>[k(A)]),_:1}))]),default:i(()=>[M(" "+j(t?"\u5C55\u5F00":"\u6536\u8D77"),1)]),_:2},1032,["onClick"])):R("",!0)]),_:2},1032,["justify","style"])]),_:1},8,["span","suffix"])):R("",!0)]),_:3},16)]),_:3},16,["model"])}var tt=_e(Ke,[["render",Xe],["__scopeId","data-v-52835ba1"]]);function nt(e){const l=V(null),o=V(!1);function m(){return _(this,null,function*(){const n=u(l);return n||console.error("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),yield We(),n})}function c(n){Qe(()=>{l.value=null,o.value=null}),!(u(o)&&be()&&n===u(l))&&(l.value=n,o.value=!0,te(()=>e,()=>{e&&n.setProps(ye(e))},{immediate:!0,deep:!0}))}return[c,{setProps:n=>_(this,null,function*(){yield(yield m()).setProps(n)}),resetFields:()=>_(this,null,function*(){m().then(n=>_(this,null,function*(){yield n.resetFields()}))}),clearValidate:n=>_(this,null,function*(){yield(yield m()).clearValidate(n)}),getFieldsValue:()=>{var n;return(n=u(l))==null?void 0:n.getFieldsValue()},setFieldsValue:n=>_(this,null,function*(){yield(yield m()).setFieldsValue(n)}),submit:()=>_(this,null,function*(){return(yield m()).submit()}),validate:n=>_(this,null,function*(){return(yield m()).validate(n)})}]}export{tt as B,nt as u};
